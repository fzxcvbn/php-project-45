#!/usr/bin/env php
<?php

require_once(__DIR__ . '/../vendor/autoload.php');
require_once('../php-project-45/src/Cli.php');

use function cli\line;
use function cli\prompt;

\welcome\ask_name();

$answer = 0;
line('What number is missing in the progression?');
for ($i = 0; $i < 3; $i++) {
    $a = rand(0, 50);
    $d = rand(0, 30);
    $elements_progression = rand(5, 15);
    $progression = [$a];
    for ($j = 1; $j < $elements_progression; $j++) {
        $c = $a + $d;
        $progression[] = ($c);
        $a = $c;
    }
    $index = rand(0, $elements_progression);
    $answer = $progression[$index];
    $replacements = array($index => "..");
    $progression = array_replace($progression, $replacements);
    print_r(implode(' ', $progression));
    print_r("\n");
    $your_answer = prompt('Your answer');
    if ($answer == $your_answer) {
        line('Correct!');
    } else {
        line("{$your_answer} is wrong answer ;(. Correct answer was {$answer}.");
        line("Let's try again, %s!", $name);
        break;
    }
    if ($i == 2) {
        line("Congratulations, %s!", $name);
    }
}
